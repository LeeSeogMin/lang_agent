# AI 검색 에이전트 프로젝트 구조 설명

## 1. 프로젝트 설정 및 실행 환경

### 가상환경 (.venv)
- Python 3.11 이상의 독립된 실행 환경을 제공
- 프로젝트의 의존성을 격리하여 관리
- Poetry를 통해 자동으로 생성되고 관리됨

### poetry.lock
- 프로젝트의 모든 의존성 패키지의 정확한 버전을 기록
- 재현 가능한 빌드 환경을 보장
- 주요 의존성:
  - streamlit: 웹 인터페이스 구현
  - openai: AI 모델 통합
  - faiss-cpu: 벡터 검색 엔진
  - python-docx: DOCX 파일 처리
  - PyPDF2: PDF 파일 처리
  - pytesseract: OCR 처리

### pyproject.toml
- 프로젝트의 메타데이터와 의존성 관리
- Poetry 설정 파일
- 프로젝트 정보, 의존성, 개발 도구 설정 포함
- 빌드 시스템 및 패키지 설정 정의

### run_app.py
- 애플리케이션의 진입점
- Streamlit 서버 설정 및 실행
- 환경 변수 로드 및 초기화
- 메인 UI 모듈 실행

## 2. 소스 코드 구조 (src/ai_agent/)

### agents/
- **controller_agent.py**: 전체 시스템의 중앙 제어
  - 다른 에이전트들의 조율
  - 사용자 요청 처리 및 응답 생성
  - 검색 결과 통합 및 요약

- **rag_agent.py**: 검색 증강 생성(Retrieval Augmented Generation) 처리
  - 문서 검색 및 관련 정보 추출
  - 컨텍스트 기반 응답 생성
  - 벡터 저장소와의 상호작용

- **web_search_agent.py**: 웹 검색 기능 구현
  - Tavily Search API 통합
  - 웹 검색 결과 처리 및 필터링
  - 검색 결과 캐싱

### config/
- **settings.py**: 전역 설정 관리
  - API 키 및 환경 변수 관리
  - 시스템 설정 및 상수 정의
  - 로깅 및 디버깅 설정

### core/
- **cache.py**: 캐시 시스템 구현
  - 검색 결과 캐싱
  - 임시 파일 관리
  - 메모리 최적화

- **document_manager.py**: 문서 관리 시스템
  - 문서 업로드 및 저장
  - 문서 메타데이터 관리
  - 문서 라이프사이클 관리

- **document_parser.py**: 문서 파싱 및 처리
  - 다양한 형식(PDF, DOCX, TXT) 지원
  - OCR 처리
  - 텍스트 추출 및 정제

- **embedding.py**: 텍스트 임베딩 처리
  - SRoBERTa 모델 통합
  - 텍스트 벡터화
  - 임베딩 캐싱

- **vector_store.py**: 벡터 저장소 관리
  - FAISS 기반 벡터 검색
  - 임베딩 저장 및 검색
  - 유사도 기반 검색

### models/
- **state.py**: 애플리케이션 상태 관리
  - 세션 상태 정의
  - UI 상태 관리
  - 데이터 모델 정의

### utils/
- **tavily_search.py**: Tavily Search API 유틸리티
  - API 요청 처리
  - 검색 결과 파싱
  - 에러 처리

## 3. 파일 간 관계

### 주요 데이터 흐름
1. 사용자 요청 → controller_agent
2. controller_agent → web_search_agent + rag_agent
3. rag_agent → vector_store + document_manager
4. 검색 결과 → controller_agent → UI

### 설정 및 상태 관리
- settings.py → 모든 모듈
- state.py → UI 및 컨트롤러

### 문서 처리 파이프라인
1. document_manager → document_parser
2. document_parser → embedding
3. embedding → vector_store

### 캐시 시스템
- cache.py → web_search_agent + embedding
- vector_store → cache.py

## 4. 확장성 및 유지보수

### 모듈화
- 각 컴포넌트는 독립적으로 동작
- 인터페이스를 통한 느슨한 결합
- 새로운 기능 추가가 용이한 구조

### 설정 관리
- 환경 변수를 통한 설정
- 설정 변경 시 코드 수정 불필요
- 개발/운영 환경 분리 용이

### 에러 처리
- 각 모듈별 독립적인 에러 처리
- 로깅을 통한 디버깅 용이
- 사용자 친화적인 에러 메시지 